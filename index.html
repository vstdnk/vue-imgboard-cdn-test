<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico">
    <!-- Метатеги для iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="TG Imgboard">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#2678b6">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-touch-fullscreen" content="yes">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/manifest.json">
    <title>TG Imgboard</title>

    <!-- Загружаем Telegram WebApp скрипт до основного приложения -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Загружаем Vue.js -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <!-- Встроенные базовые стили -->
    <style>
      :root {
        --tg-theme-bg-color: #ffffff;
        --tg-theme-text-color: #222222;
        --tg-theme-hint-color: #999999;
        --tg-theme-link-color: #2678b6;
        --tg-theme-button-color: #2678b6;
        --tg-theme-button-text-color: #ffffff;
        --tg-theme-secondary-bg-color: #f5f5f5;
        --safe-area-inset-top: env(safe-area-inset-top, 0px);
        --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
      }
      
      html.dark {
        --tg-theme-bg-color: #212121;
        --tg-theme-text-color: #ffffff;
        --tg-theme-hint-color: #aaaaaa;
        --tg-theme-link-color: #8cc2ff;
        --tg-theme-button-color: #2678b6;
        --tg-theme-button-text-color: #ffffff;
        --tg-theme-secondary-bg-color: #292929;
      }
      
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
      }
      
      html, body {
        height: 100%;
        width: 100%;
        padding: 0;
        margin: 0;
        overflow: hidden;
      }
      
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background-color: var(--tg-theme-bg-color);
        color: var(--tg-theme-text-color);
        /* Предотвращение прокрутки и полноэкранный режим */
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        overflow: hidden;
        -webkit-text-size-adjust: 100%;
        -webkit-font-smoothing: antialiased;
      }
      
      /* Специфичные стили для iOS в полноэкранном режиме */
      body.ios-fullscreen {
        /* Убираем отступы для полного экрана */
        padding: 0;
        margin: 0;
        /* Фиксация размера экрана */
        height: 100vh;
        height: -webkit-fill-available;
        width: 100vw;
        /* Предотвращение скролла */
        overflow: hidden;
        -webkit-overflow-scrolling: touch;
        /* Полноэкранное позиционирование */
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
      }
      
      #app {
        height: 100%;
        width: 100%;
        overflow-y: auto;
        overflow-x: hidden;
        -webkit-overflow-scrolling: touch;
        position: relative;
        /* Разрешаем прокрутку свайпом */
        touch-action: pan-y;
      }
      
      #app-loading {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background-color: var(--tg-theme-bg-color);
        color: var(--tg-theme-text-color);
        transition: opacity 0.3s;
        z-index: 9999;
      }
      
      #app-loading.hidden {
        opacity: 0;
        pointer-events: none;
        z-index: -1;
      }
      
      .spinner {
        width: 40px;
        height: 40px;
        margin-bottom: 20px;
        border: 4px solid rgba(0, 0, 0, 0.1);
        border-left-color: var(--tg-theme-button-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      
      html.dark .spinner {
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-left-color: var(--tg-theme-link-color);
      }
      
      .loading-text {
        font-size: 14px;
        letter-spacing: 1px;
        font-weight: bold;
      }
      
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      

      
      /* Индикатор загрузки */
      .loader {
        width: 24px;
        height: 24px;
        border: 3px solid rgba(0,0,0,0.1);
        border-radius: 50%;
        border-top-color: var(--tg-theme-button-color);
        animation: spin 1s linear infinite;
        margin-top: 8px;
      }
      
      html.dark .loader {
        border-color: rgba(255,255,255,0.1);
        border-top-color: var(--tg-theme-button-color);
      }

      /* Стили для досок */
      .boards-container {
        padding: 16px;
        max-width: 1200px;
        margin: 0 auto;
      }

      .main-title {
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        margin-bottom: 32px;
        color: var(--tg-theme-text-color);
      }

      .category-section {
        margin-bottom: 32px;
      }

      .category-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 16px;
        padding: 12px 16px;
        background-color: var(--tg-theme-secondary-bg-color);
        border-radius: 8px;
        color: var(--tg-theme-text-color);
        border-left: 4px solid var(--tg-theme-button-color);
      }

             .boards-grid {
         display: flex;
         flex-wrap: wrap;
         gap: 12px;
         padding: 16px;
         background-color: var(--tg-theme-secondary-bg-color);
         border-radius: 12px;
         border: 1px solid rgba(0,0,0,0.1);
       }

       html.dark .boards-grid {
         border-color: rgba(255,255,255,0.1);
       }

               .board-card {
          background-color: var(--tg-theme-bg-color);
          border-radius: 8px;
          padding: 12px 16px;
          transition: all 0.2s ease;
          /*border: 1px solid rgba(0,0,0,0.08);*/
          min-width: 200px;
          flex: 1 1 auto;
          position: relative;
          cursor: pointer;
          user-select: none;
        }

        /* Добавляем разделители между досками */
        .board-card:not(:last-child)::after {
          content: '';
          position: absolute;
          bottom: 0;
          left: 16px;
          right: 16px;
          height: 1px;
          background-color: rgba(0, 0, 0, 0.1);
        }

        html.dark .board-card:not(:last-child)::after {
          background-color: rgba(255, 255, 255, 0.1);
        }

       html.dark .board-card {
         background-color: var(--tg-theme-secondary-bg-color);
         border-color: rgba(255,255,255,0.08);
       }

       .board-card:hover {
         transform: translateY(-1px);
         box-shadow: 0 2px 8px rgba(0,0,0,0.1);
         background-color: var(--tg-theme-secondary-bg-color);
       }

       html.dark .board-card:hover {
         background-color: var(--tg-theme-bg-color);
       }

      .app-header {
       /*background-color: rgba(0, 0, 0, 0.08);*/
       width: 100%;
       height: 100px;
       padding: 100px;
       padding-bottom: 50px;
       /*border: 1px solid rgba(0,0,0,0.1);*/
       display: flex;
       justify-content: center;
       align-items: center;

      }
      .board-header {
        margin-bottom: 8px;
      }

      .board-link {
        text-decoration: none;
        color: var(--tg-theme-text-color);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .board-link:hover {
        color: var(--tg-theme-link-color);
      }

      .board-id {
        font-family: monospace;
        font-weight: bold;
        color: var(--tg-theme-button-color);
        font-size: 14px;
      }

      .board-name {
        font-weight: 600;
        font-size: 16px;
      }

      .board-info {
        font-size: 14px;
        color: var(--tg-theme-hint-color);
        line-height: 1.4;
      }

                     /* Адаптивность для мобильных устройств */
        @media (max-width: 768px) {
          .boards-grid {
            flex-direction: column;
            padding: 12px;
          }
          
          .board-card {
            min-width: auto;
            width: 100%;
          }

          /* Адаптируем разделители для мобильных */
          .board-card:not(:last-child)::after {
            left: 12px;
            right: 12px;
          }
          
          .boards-container {
            padding: 12px;
          }
          
          .main-title {
            font-size: 20px;
            margin-bottom: 24px;
          }
          
          .category-title {
            font-size: 16px;
            padding: 10px 14px;
          }
          
          /* Улучшаем прокрутку на мобильных */
          #app {
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: contain;
          }
          
          .boards-container {
            overscroll-behavior: contain;
          }
        }
    </style>
  </head>
  <body>
    <!-- Базовый экран загрузки -->
    <div id="app-loading">
      <div class="spinner"></div>
      <div class="loading-text">BOARD LOADING...</div>
    </div>
    

    
    <!-- Контейнер для Vue приложения -->
    <div id="app" style="display: none;"></div>

    <script>
      // Определяем iOS устройства
      var isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) || (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
      
      // Базовая проверка наличия Telegram WebApp API
      window.addEventListener('DOMContentLoaded', function() {
        console.log('DOMContentLoaded сработал');
        
        // Элементы страницы
        var appLoading = document.getElementById('app-loading');
        var vueApp = document.getElementById('app');
        var isAppHidden = false;
        
        console.log('Элементы найдены:', { appLoading, vueApp });
        
        // Настраиваем для iOS
        if (isIOS) {
          document.body.classList.add('ios');
          
          // Специальные настройки для iOS полноэкранного режима
          // Предотвращаем скроллинг страницы целиком на iOS
          document.addEventListener('touchmove', function(event) {
            // Разрешаем скроллинг внутри приложения
            if (event.target.closest('#app') || event.target.closest('.boards-container')) {
              return; // Разрешаем прокрутку
            }
            // Блокируем прокрутку только для body
            event.preventDefault();
          }, { passive: false });
        }
        
        // Инициализация Telegram API
        var tg = null;
        if (window.Telegram && window.Telegram.WebApp) {
          tg = window.Telegram.WebApp;
          
          // Отключаем свайп вниз для закрытия приложения
          try {
            if (window.Telegram && window.Telegram.WebApp) {
              var eventData = JSON.stringify({ allow_vertical_swipe: false });
              if (window.TelegramWebviewProxy) {
                window.TelegramWebviewProxy.postEvent('web_app_setup_swipe_behavior', eventData);
              } else {
                window.parent.postMessage(JSON.stringify({
                  eventType: 'web_app_setup_swipe_behavior',
                  eventData: { allow_vertical_swipe: false }
                }), 'https://web.telegram.org');
              }
              console.log('Свайп вниз отключен');
            }
          } catch (e) {
            console.error('Ошибка при отключении свайпа вниз:', e);
          }
          
          // Скрываем кнопку "Назад" в левом верхнем углу
          try {
            if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.BackButton) {
              window.Telegram.WebApp.BackButton.hide();
              console.log('Кнопка "Назад" скрыта');
            }
          } catch (e) {
            console.error('Ошибка при скрытии кнопки "Назад":', e);
          }
          
          // Блокировка ориентации экрана в портретном режиме
          try {
            if (window.Telegram && window.Telegram.WebApp) {
              var orientationData = JSON.stringify({ locked: true });
              if (window.TelegramWebviewProxy) {
                window.TelegramWebviewProxy.postEvent('web_app_toggle_orientation_lock', orientationData);
              } else {
                window.parent.postMessage(JSON.stringify({
                  eventType: 'web_app_toggle_orientation_lock',
                  eventData: { locked: true }
                }), 'https://web.telegram.org');
              }
              console.log('Ориентация экрана заблокирована');
            }
          } catch (e) {
            console.error('Ошибка при блокировке ориентации экрана:', e);
          }
          
          // Применяем темную тему если нужно
          if (tg.colorScheme === 'dark') {
            document.documentElement.classList.add('dark');
          }
          
          // Настройка переменных CSS на основе Telegram темы
          if (tg.themeParams) {
            document.documentElement.style.setProperty('--tg-theme-bg-color', tg.themeParams.bg_color);
            document.documentElement.style.setProperty('--tg-theme-text-color', tg.themeParams.text_color);
            document.documentElement.style.setProperty('--tg-theme-hint-color', tg.themeParams.hint_color);
            document.documentElement.style.setProperty('--tg-theme-link-color', tg.themeParams.link_color);
            document.documentElement.style.setProperty('--tg-theme-button-color', tg.themeParams.button_color);
            document.documentElement.style.setProperty('--tg-theme-button-text-color', tg.themeParams.button_text_color);
            document.documentElement.style.setProperty('--tg-theme-secondary-bg-color', tg.themeParams.secondary_bg_color);
          }
          
          // Функция активации полноэкранного режима
          var toggleFullScreen = function() {
            try {
              // Скрываем кнопки
              if (window.Telegram && window.Telegram.WebApp) {
                if (window.Telegram.WebApp.BackButton) window.Telegram.WebApp.BackButton.hide();
                if (window.Telegram.WebApp.MainButton) window.Telegram.WebApp.MainButton.hide();
                if (window.Telegram.WebApp.disableSwipeToClose) window.Telegram.WebApp.disableSwipeToClose();
              }
              
              // Добавляем класс для iOS
              if (isIOS) document.body.classList.add('ios-fullscreen');
              
              // Расширяем окно всеми доступными методами
              if (tg.expand) tg.expand();
              if (tg.requestFullscreen) tg.requestFullscreen();
              if (window.Telegram && window.Telegram.WebApp) {
                if (window.Telegram.WebApp.expand) window.Telegram.WebApp.expand();
                if (window.Telegram.WebApp.setViewportHeight) window.Telegram.WebApp.setViewportHeight(1.0);
              }
              
              // Отправляем событие для расширения
              try {
                var expandData = JSON.stringify({force: true});
                if (window.TelegramWebviewProxy) {
                  window.TelegramWebviewProxy.postEvent('web_app_expand', expandData);
                } else {
                  window.parent.postMessage(JSON.stringify({
                    eventType: 'web_app_expand',
                    eventData: {force: true}
                  }), '*');
                }
              } catch (e) {}
              
              // Устанавливаем viewport
              var viewportMeta = document.querySelector('meta[name="viewport"]');
              if (viewportMeta) {
                viewportMeta.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover');
              }
            } catch (e) {
              console.error('Ошибка полноэкранного режима:', e);
            }
          };

          // Автоматически активируем полноэкранный режим при загрузке
          // Функция активации полноэкранного режима с повторами
          var activateFullScreenMode = function(attempts) {
            attempts = attempts || 0;
            var maxAttempts = isIOS ? 3 : 2;
            try {
              toggleFullScreen();
              if (isIOS && attempts < maxAttempts) {
                setTimeout(function() {
                  activateFullScreenMode(attempts + 1);
                }, 300);
              }
            } catch (e) {
              if (attempts < maxAttempts) {
                setTimeout(function() {
                  activateFullScreenMode(attempts + 1);
                }, 300);
              }
            }
          };
          
          // Запускаем активацию полноэкранного режима
          setTimeout(activateFullScreenMode, isIOS ? 500 : 200);
          
          // Дополнительные события для iOS
          if (isIOS) {
            // При загрузке страницы
            window.addEventListener('load', function() {
              setTimeout(activateFullScreenMode, 500);
            });
            
            // При возвращении на страницу
            document.addEventListener('visibilitychange', function() {
              if (!document.hidden) setTimeout(activateFullScreenMode, 300);
            });
            
            // При получении фокуса
            window.addEventListener('focus', function() {
              setTimeout(activateFullScreenMode, 300);
            });
            
            // При восстановлении из кэша
            window.addEventListener('pageshow', function(event) {
              if (event.persisted) setTimeout(activateFullScreenMode, 300);
            });
          }
        }
        
        // Функция скрытия экрана загрузки
        window.hideLoading = function() {
          if (isAppHidden) return; // Предотвращаем повторное скрытие
          isAppHidden = true;
          
          console.log('Скрываем экран загрузки, показываем Vue приложение');
          
          // Скрываем экран загрузки
          appLoading.classList.add('hidden');
          
          // Показываем Vue приложение
          vueApp.style.display = 'block';
          
          try {
                    // Инициализация Vue после DOMContentLoaded
        console.log('Начинаем инициализацию Vue...');
        const { createApp } = Vue;

            createApp({
              data() {
                return {
                  boards: [
                    {
                      id: "a",
                      name: "Аниме",
                      category: "Японская культура",
                      info_outer: "аниме, 2d, вайфу",
                      link: "/a/"
                    },
                    {
                      id: "b",
                      name: "Бред",
                      category: "Разное",
                      info_outer: "бред",
                      link: "/b/"
                    },
                    {
                      id: "bi",
                      name: "Велосипеды",
                      category: "Тематика",
                      info_outer: "велосипеды, dmx",
                      link: "/bi/"
                    },
                    {
                      id: "biz",
                      name: "Бизнес",
                      category: "Тематика",
                      info_outer: "бизнес, сириуз бизнес",
                      link: "/biz/"
                    },
                    {
                      id: "bo",
                      name: "Книги",
                      category: "Тематика",
                      info_outer: "книги, чтение",
                      link: "/bo/"
                    },
                    {
                      id: "c",
                      name: "Комиксы и мультфильмы",
                      category: "Тематика",
                      info_outer: "комиксы, мультфильмы",
                      link: "/c/"
                    },
                    {
                      id: "dev",
                      name: "Тянач",
                      category: "",
                      info_outer: "",
                      link: "/dev/"
                    },
                    {
                      id: "em",
                      name: "Другие страны",
                      category: "Тематика",
                      info_outer: "эмиграция, страны",
                      link: "/em/"
                    },
                    {
                      id: "ew",
                      name: "Конец света",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/ew/"
                    },
                    {
                      id: "fa",
                      name: "Мода и стиль",
                      category: "Тематика",
                      info_outer: "мода, стиль, шмотки, стрижки, партаки, рюкзаки, парфюм, патлы",
                      link: "/fa/"
                    },
                    {
                      id: "fiz",
                      name: "Физкультура",
                      category: "Тематика",
                      info_outer: "физкультура, здоровье, сбросить вес, набрать вес, бицуха",
                      link: "/fiz/"
                    },
                    {
                      id: "fl",
                      name: "Иностранные языки",
                      category: "Тематика",
                      info_outer: "иностранные языки, мунспик, эльфийский",
                      link: "/fl/"
                    },
                    {
                      id: "ftb",
                      name: "Футбол",
                      category: "Тематика",
                      info_outer: "футбол, премьер лига, ногомяч",
                      link: "/ftb/"
                    },
                    {
                      id: "hh",
                      name: "Hip-Hop",
                      category: "Пользовательские",
                      info_outer: "хипхоп, рэп, олдскул",
                      link: "/hh/"
                    },
                    {
                      id: "hi",
                      name: "История",
                      category: "Тематика",
                      info_outer: "история",
                      link: "/hi/"
                    },
                    {
                      id: "hw",
                      name: "Железо и Техника",
                      category: "Техника и софт",
                      info_outer: "железо, видеокарты, ноутбуки, intel, amd, nvidia, ati",
                      link: "/hw/"
                    },
                    {
                      id: "me",
                      name: "Медицина",
                      category: "Тематика",
                      info_outer: "медицина, здоровье, диагностика, сходи к врачу",
                      link: "/me/"
                    },
                    {
                      id: "mg",
                      name: "Магия",
                      category: "Тематика",
                      info_outer: "магия, астрал, вуду, руны, псионика, суккубы",
                      link: "/mg/"
                    },
                    {
                      id: "mlp",
                      name: "My Little Pony",
                      category: "Тематика",
                      info_outer: "Мои маленькие пони, дружба, магия",
                      link: "/mlp/"
                    },
                    {
                      id: "mo",
                      name: "Мотоциклы",
                      category: "Тематика",
                      info_outer: "Мотоциклы, скутеры, трайки, экипировка",
                      link: "/mo/"
                    },
                    {
                      id: "ne",
                      name: "Животные и природа",
                      category: "Тематика",
                      info_outer: "",
                      link: "/ne/"
                    },
                    {
                      id: "pvc",
                      name: "Фигурки",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/pvc/"
                    },
                    {
                      id: "ph",
                      name: "Философия",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/ph/"
                    },
                                         {
                       id: "po",
                       name: "Политика",
                       category: "Политика и новости",
                       info_outer: "политика, новости, ольгинцы, хохлы, либерахи, рептилоиды.. oh shi",
                       link: "/po/"
                     },
                    {
                      id: "pr",
                      name: "Программирование",
                      category: "Техника и софт",
                      info_outer: "программирование, быдлокодинг",
                      link: "/pr/"
                    },
                    {
                      id: "psy",
                      name: "Психология и психиатрия",
                      category: "Тематика",
                      info_outer: "психология, психиатрия",
                      link: "/psy/"
                    },
                    {
                      id: "ra",
                      name: "Радиотехника",
                      category: "Тематика",
                      info_outer: "радиолюбители, связь, радиотехника",
                      link: "/ra/"
                    },
                    {
                      id: "re",
                      name: "Религия",
                      category: "Тематика",
                      info_outer: "религия, религиозная философия",
                      link: "/re/"
                    },
                    {
                      id: "s",
                      name: "Программы",
                      category: "Техника и софт",
                      info_outer: "linux, windows, шиндовс, программы",
                      link: "/s/"
                    },
                    {
                      id: "sf",
                      name: "Научная фантастика",
                      category: "Тематика",
                      info_outer: "научная фантастика, science fiction, sci-fi",
                      link: "/sf/"
                    },
                    {
                      id: "sci",
                      name: "Наука",
                      category: "Тематика",
                      info_outer: "наука",
                      link: "/sci/"
                    },
                    {
                      id: "sn",
                      name: "Паранормальные явления",
                      category: "Тематика",
                      info_outer: "крипи, паранормальные явления",
                      link: "/sn/"
                    },
                    {
                      id: "sp",
                      name: "Спорт",
                      category: "Тематика",
                      info_outer: "спорт, спортивные игры, футбол в /ftb/",
                      link: "/sp/"
                    },
                    {
                      id: "spc",
                      name: "Космос и астрономия",
                      category: "Тематика",
                      info_outer: "космос, астрономия, вселенные, звезды, огурцы",
                      link: "/spc/"
                    },
                    {
                      id: "t",
                      name: "Техника",
                      category: "Пользовательские",
                      info_outer: "техника, технологии, компьютерная периферия",
                      link: "/t/"
                    },
                    {
                      id: "tr",
                      name: "Транспорт и авиация",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/tr/"
                    },
                    {
                      id: "tv",
                      name: "Сериалы",
                      category: "Тематика",
                      info_outer: "сериалы для домохозяек",
                      link: "/tv/"
                    },
                    {
                      id: "un",
                      name: "Образование",
                      category: "Тематика",
                      info_outer: "образование, вуз, школа, поступление, гиа, егэ, уже не школьник",
                      link: "/un/"
                    },
                    {
                      id: "w",
                      name: "Оружие",
                      category: "Тематика",
                      info_outer: "оружие, ножи, стволы",
                      link: "/w/"
                    },
                    {
                      id: "wh",
                      name: "Warhammer",
                      category: "Тематика",
                      info_outer: "вархаммер ФБ, вархаммер 4000",
                      link: "/wh/"
                    },
                    {
                      id: "wm",
                      name: "Военная техника",
                      category: "Тематика",
                      info_outer: "военная техника, армии, вооруженные конфликты",
                      link: "/wm/"
                    },
                    {
                      id: "di",
                      name: "Столовая",
                      category: "Творчество",
                      info_outer: "еда, хрючево, столовая, рецепты",
                      link: "/di/"
                    },
                    {
                      id: "de",
                      name: "Дизайн",
                      category: "Творчество",
                      info_outer: "",
                      link: "/de/"
                    },
                    {
                      id: "diy",
                      name: "Хобби",
                      category: "Творчество",
                      info_outer: "хобби, лего, клеить танчики, вышивание",
                      link: "/diy/"
                    },
                    {
                      id: "dom",
                      name: "Домострой",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/dom/"
                    },
                    {
                      id: "izd",
                      name: "Графомания",
                      category: "Пользовательские",
                      info_outer: "графомания, пасты, рассказы, романы",
                      link: "/izd/"
                    },
                    {
                      id: "mus",
                      name: "Музыканты",
                      category: "Творчество",
                      info_outer: "музыкальные инструменты, вокал, DAW, звукозапись, диджеи, дикторы",
                      link: "/mus/"
                    },
                    {
                      id: "pa",
                      name: "Живопись",
                      category: "Творчество",
                      info_outer: "живопись, рисунки, художники",
                      link: "/pa/"
                    },
                    {
                      id: "p",
                      name: "Фотография",
                      category: "Творчество",
                      info_outer: "фотография, фототехника, объективы, canon, nikon, sony, pentax",
                      link: "/p/"
                    },
                    {
                      id: "wp",
                      name: "Обои и высокое разрешение",
                      category: "Творчество",
                      info_outer: "",
                      link: "/wp/"
                    },
                    {
                      id: "td",
                      name: "Трёхмерная графика",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/td/"
                    },
                    {
                      id: "bg",
                      name: "Настольные игры",
                      category: "Игры",
                      info_outer: "настольные игры",
                      link: "/bg/"
                    },
                    {
                      id: "cg",
                      name: "Консоли",
                      category: "Игры",
                      info_outer: "консоли, playstation, xbox, nintendo",
                      link: "/cg/"
                    },
                    {
                      id: "mc",
                      name: "Minecraft",
                      category: "Пользовательские",
                      info_outer: "майнкрафт, сервера",
                      link: "/mc/"
                    },
                    {
                      id: "mmo",
                      name: "Massive multiplayer online games",
                      category: "Игры",
                      info_outer: "multiplayer games, mmo, wow, wot, eve, lineage",
                      link: "/mmo/"
                    },
                    {
                      id: "tes",
                      name: "The Elder Scrolls",
                      category: "Игры",
                      info_outer: "TES, elder scrolls, morrowind, skyrim, oblivion, fusrodah",
                      link: "/tes/"
                    },
                    {
                      id: "vg",
                      name: "Video Games General",
                      category: "Игры",
                      info_outer: "Видеоигры, general, официальные треды",
                      link: "/vg/"
                    },
                    {
                      id: "wr",
                      name: "Текстовые авторские рпг",
                      category: "Игры",
                      info_outer: "текстовые рпг",
                      link: "/wr/"
                    },
                    {
                      id: "aa",
                      name: "Аниме арт",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/aa/"
                    },
                    {
                      id: "fd",
                      name: "Фэндом",
                      category: "Японская культура",
                      info_outer: "фэндом, косплей, японская культура, аниме",
                      link: "/fd/"
                    },
                    {
                      id: "ja",
                      name: "Японская культура",
                      category: "Японская культура",
                      info_outer: "",
                      link: "/ja/"
                    },
                    {
                      id: "ma",
                      name: "Манга",
                      category: "Японская культура",
                      info_outer: "манга, наруто, блич, японские комиксы",
                      link: "/ma/"
                    },
                    {
                      id: "rm",
                      name: "Rozen Maiden",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/rm/"
                    },
                    {
                      id: "to",
                      name: "Touhou",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/to/"
                    },
                    {
                      id: "vn",
                      name: "Визуальные новеллы",
                      category: "Японская культура",
                      info_outer: "визуальные новеллы",
                      link: "/vn/"
                    },
                    {
                      id: "d",
                      name: "Скла/d/ грязи",
                      category: "Разное",
                      info_outer: "двач, модерация, разбань, забань, убери, верни, зделай",
                      link: "/d/"
                    },
                    {
                      id: "fag",
                      name: "Фагготрия",
                      category: "Взрослым",
                      info_outer: "фагготрия, богини",
                      link: "/fag/"
                    },
                    {
                      id: "soc",
                      name: "Общение",
                      category: "Разное",
                      info_outer: "сходки, знакомства, деанонимизация",
                      link: "/soc/"
                    },
                    {
                      id: "r",
                      name: "Просьбы",
                      category: "Разное",
                      info_outer: "реквесты, ищу пикчу, вебмку, пасту",
                      link: "/r/"
                    },
                    {
                      id: "fg",
                      name: "Трапы",
                      category: "Взрослым",
                      info_outer: "",
                      link: "/fg/"
                    },
                    {
                      id: "fur",
                      name: "Фурри",
                      category: "Взрослым",
                      info_outer: "",
                      link: "/fur/"
                    },
                    {
                      id: "gg",
                      name: "Хорошие девушки",
                      category: "Взрослым",
                      info_outer: "",
                      link: "/gg/"
                    },
                    {
                      id: "ga",
                      name: "Геи",
                      category: "Взрослым",
                      info_outer: "",
                      link: "/ga/"
                    },
                    {
                      id: "h",
                      name: "Хентай",
                      category: "Взрослым",
                      info_outer: "",
                      link: "/h/"
                    },
                    {
                      id: "ho",
                      name: "Прочий хентай",
                      category: "Взрослым",
                      info_outer: "",
                      link: "/ho/"
                    },
                    {
                      id: "web",
                      name: "Web-мастера",
                      category: "Пользовательские",
                      info_outer: "вебмастера, seo, реклама, пиар",
                      link: "/web/"
                    },
                    {
                      id: "gd",
                      name: "Gamedev",
                      category: "Техника и софт",
                      info_outer: "gamedev, игрострой, эльфы набегают",
                      link: "/gd/"
                    },
                    {
                      id: "mov",
                      name: "Фильмы",
                      category: "Тематика",
                      info_outer: "фильмы, кино, новинки, сериалы в /tv/",
                      link: "/mov/"
                    },
                    {
                      id: "rf",
                      name: "Убежище",
                      category: "Тематика",
                      info_outer: "убежище, социофобия",
                      link: "/rf/"
                    },
                    {
                      id: "br",
                      name: "Барахолка",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/br/"
                    },
                    {
                      id: "wrk",
                      name: "Работа и карьера",
                      category: "Творчество",
                      info_outer: "работа, карьера, офис, макдональдс",
                      link: "/wrk/"
                    },
                    {
                      id: "mu",
                      name: "Музыка",
                      category: "Тематика",
                      info_outer: "музыка, илита",
                      link: "/mu/"
                    },
                    {
                      id: "trv",
                      name: "Путешествия и отдых",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/trv/"
                    },
                    {
                      id: "au",
                      name: "Автомобили",
                      category: "Тематика",
                      info_outer: "автомобили, семейные биопроблемы, шкворни, патриот, сломалась дсг, тазопроблемы",
                      link: "/au/"
                    },
                    {
                      id: "gb",
                      name: "Азартные игры",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/gb/"
                    },
                    {
                      id: "asylum",
                      name: "Убежище",
                      category: "",
                      info_outer: "",
                      link: "/asylum/"
                    },
                    {
                      id: "fs",
                      name: "Фэнтези",
                      category: "Пользовательские",
                      info_outer: "фэнтези",
                      link: "/fs/"
                    },
                    {
                      id: "fet",
                      name: "Фетиш",
                      category: "Взрослым",
                      info_outer: "",
                      link: "/fet/"
                    },
                    {
                      id: "e",
                      name: "Extreme Pron",
                      category: "Взрослым",
                      info_outer: "",
                      link: "/e/"
                    },
                    {
                      id: "hc",
                      name: "Hardcore",
                      category: "Взрослым",
                      info_outer: "",
                      link: "/hc/"
                    },
                    {
                      id: "moba",
                      name: "Multiplayer Online Battle Arena games",
                      category: "Игры",
                      info_outer: "dota, lol, hots, moba",
                      link: "/moba/"
                    },
                    {
                      id: "mobi",
                      name: "Мобильные устройства и приложения",
                      category: "Техника и софт",
                      info_outer: "мобильные телефоны, приложения, iphone, android, winphone, 2ch browser",
                      link: "/mobi/"
                    },
                    {
                      id: "abu",
                      name: "abu",
                      category: "Разное",
                      info_outer: "",
                      link: "/abu/"
                    },
                    {
                      id: "cul",
                      name: "Культура",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/cul/"
                    },
                    {
                      id: "out",
                      name: "Активный отдых",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/out/"
                    },
                    {
                      id: "old",
                      name: "Олдфаги",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/old/"
                    },
                    {
                      id: "cc",
                      name: "Криптовалюта",
                      category: "Тематика",
                      info_outer: "",
                      link: "/cc/"
                    },
                    {
                      id: "media",
                      name: "Анимация",
                      category: "Разное",
                      info_outer: "webm, gif, youtube, медиа",
                      link: "/media/"
                    },
                    {
                      id: "zog",
                      name: "Теории заговора",
                      category: "Тематика",
                      info_outer: "не стоит вскрывать эту тему",
                      link: "/zog/"
                    },
                    {
                      id: "ussr",
                      name: "СССР",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/ussr/"
                    },
                    {
                      id: "jsf",
                      name: "Japanese Street Fashion",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/jsf/"
                    },
                    {
                      id: "ukr",
                      name: "/Ukr/aine — Україна",
                      category: "Пользовательские",
                      info_outer: "украина, че там у хохлов",
                      link: "/ukr/"
                    },
                    {
                      id: "sw",
                      name: "Star Wars",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/sw/"
                    },
                    {
                      id: "law",
                      name: "Право и правоприменители",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/law/"
                    },
                    {
                      id: "m",
                      name: "Меха",
                      category: "Пользовательские",
                      info_outer: "Тематика для всей научной фантастики с роботами и космическими кораблями. Гандамы, Метал Гиры и прочее.",
                      link: "/m/"
                    },
                    {
                      id: "ya",
                      name: "Яой",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/ya/"
                    },
                    {
                      id: "r34",
                      name: "Правило 34",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/r34/"
                    },
                    {
                      id: "qtr4",
                      name: "qtr4",
                      category: "Пользовательские",
                      info_outer: "",
                      link: "/qtr4/"
                    },
                    {
                      id: "wow",
                      name: "World of Warcraft",
                      category: "Пользовательские",
                      info_outer: "wow, world of warcraft",
                      link: "/wow/"
                    }
                  ]
                };
              },
                             methods: {
                 getBoardsByCategory() {
                   const categories = {};
                   this.boards.forEach(board => {
                     const category = board.category || 'Без категории';
                     if (!categories[category]) {
                       categories[category] = [];
                     }
                     categories[category].push(board);
                   });
                   
                   // Определяем порядок отображения разделов
                   const categoryOrder = [
                     'Тематика',
                     'Творчество', 
                     'Политика и новости',
                     'Техника и софт',
                     'Игры',
                     'Взрослым',
                     'Японская культура',
                     'Разное',
                     'Новые доски',
                     'Пользовательские'
                   ];
                   
                   // Сортируем категории по заданному порядку
                   const sortedCategories = {};
                   categoryOrder.forEach(catName => {
                     if (categories[catName]) {
                       sortedCategories[catName] = categories[catName];
                     }
                   });
                   
                   // Добавляем оставшиеся категории в конец
                   Object.keys(categories).forEach(catName => {
                     if (!categoryOrder.includes(catName)) {
                       sortedCategories[catName] = categories[catName];
                     }
                   });
                   
                   return sortedCategories;
                 },
                 
                                   openBoard(boardId) {
                    // Переходим на страницу доски
                    console.log('Клик по доске:', boardId);
                    console.log('Переходим на:', `board.html?id=${boardId}`);
                    
                    try {
                      // Пробуем разные способы навигации
                      if (window.Telegram && window.Telegram.WebApp) {
                        // В Telegram WebApp используем location.assign
                        window.location.assign(`board.html?id=${boardId}`);
                      } else {
                        // В обычном браузере используем href
                        window.location.href = `board.html?id=${boardId}`;
                      }
                    } catch (e) {
                      console.error('Ошибка при переходе:', e);
                      // Fallback
                      window.location.href = `board.html?id=${boardId}`;
                    }
                  }
               },
              template: `
                <div class="boards-container">
                  <div class="app-header">
                    <h1 class="main-title">СПИСОК РАЗДЕЛОВ</h1>
                  </div>
                  <div v-for="(boards, category) in getBoardsByCategory()" :key="category" class="category-section">
                    <h2 class="category-title">{{ category }}</h2>
                    <div class="boards-grid">
                                             <div v-for="board in boards" :key="board.id" class="board-card" @click="openBoard(board.id)">
                         <div class="board-header">
                           <div class="board-link">
                             <span class="board-id">/{{ board.id }}/</span>
                             <span class="board-name">{{ board.name }}</span>
                           </div>
                         </div>
                         <div class="board-info" v-if="board.info_outer">
                           {{ board.info_outer }}
                         </div>
                       </div>
                    </div>
                  </div>
                </div>
              `
            }).mount('#app');

            console.log('Vue приложение успешно инициализировано');
            // Vue приложение уже показано в hideLoading
          } catch (e) {
            console.error('Ошибка при инициализации Vue:', e);
          }
        };
        
        // Инициализация Telegram WebApp и автоматическое скрытие экрана загрузки
        setTimeout(function() {
          if (window.Telegram && window.Telegram.WebApp) {
            try {
              // Сообщаем Telegram что приложение готово
              window.Telegram.WebApp.ready();
              window.Telegram.WebApp.expand();
              
              // Принудительно устанавливаем полноэкранный режим
              document.documentElement.style.height = '100%';
              document.body.style.height = '100%';
            } catch (e) {
              console.error('Ошибка при инициализации Telegram WebApp:', e);
            }
          }
          
          // ВАЖНО: Принудительно скрываем экран загрузки через 1 секунду
          // Для iOS делаем немного дольше
          setTimeout(function() {
            window.hideLoading();
          }, isIOS ? 1000 : 500);
        }, 100);
        
        // Дополнительная защита: скрываем экран загрузки при загрузке страницы
        window.addEventListener('load', function() {
          setTimeout(function() {
            window.hideLoading();
          }, 500);
        });
      });
    </script>
    

  </body>
</html>
